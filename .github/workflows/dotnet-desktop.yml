name: .NET Core Desktop  
on:  
  push:  
    branches: [ "main" ]  
  pull_request:  
    branches: [ "main" ]  
  
jobs:  
  build:  
    strategy:  
      matrix:  
        configuration: [Debug, Release]  
  
    runs-on: windows-latest  
  
    env:  
      Solution_Name: WindowsDiskClear.sln  
      Test_Project_Path: WindowsDiskClear.csproj  
      Wap_Project_Directory: YourWapProjectDirectoryName  # Replace with the relative path to your Wap project directory  
      Base64_Encoded_Pfx: ${{ secrets.Base64_Encoded_Pfx }}  # Assuming this is a secret set in your repository  
  
    steps:  
    - name: Checkout  
      uses: actions/checkout@v3  
      with:  
        fetch-depth: 0  
  
    - name: Install .NET Core  
      uses: actions/setup-dotnet@v3  
      with:  
        dotnet-version: 6.0.x  
  
    - name: Setup MSBuild.exe  
      uses: microsoft/setup-msbuild@v1.0.2  
  
    - name: Execute unit tests  
      run: dotnet test  
  
    - name: Restore the application  
      run: msbuild $env:Solution_Name /t:Restore /p:Configuration=$env:Configuration  
  
    - name: Decode the pfx  
      run: |  
        $pfx_cert_byte = [System.Convert]::FromBase64String($env:Base64_Encoded_Pfx)  
        $certificatePath = Join-Path -Path $env:Wap_Project_Directory -ChildPath "GitHubActionsWorkflow.pfx"  
        [IO.File]::WriteAllBytes($certificatePath, $pfx_cert_byte)  
  
    # Continue with your other steps...
